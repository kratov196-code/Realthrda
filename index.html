<!DOCTYPE html>
<html>
<head>
    <title>Только видео</title>
</head>
<body>
    <div style="display: flex; gap: 10px;">
        <div>
            <h3>Ваше видео</h3>
            <video id="localVideo" autoplay muted style="width: 400px; border: 2px solid blue;"></video>
        </div>
        <div>
            <h3>Друг</h3>
            <video id="remoteVideo" autoplay style="width: 400px; border: 2px solid green;"></video>
        </div>
    </div>

    <div style="margin-top: 20px;">
        <button onclick="startCall()">Начать звонок</button>
        <button onclick="answerCall()">Принять звонок</button>
    </div>

    <script>
        let localStream;
        let peerConnection;
        
        // 1. Получить доступ к камере
        async function startCall() {
            localStream = await navigator.mediaDevices.getUserMedia({ video: true, audio: false });
            document.getElementById('localVideo').srcObject = localStream;
            
            createPeerConnection();
            const offer = await peerConnection.createOffer();
            await peerConnection.setLocalDescription(offer);
            
            // Показать предложение для копирования
            alert("Скопируйте это и отправьте другу:\n" + JSON.stringify(offer));
        }
        
        // 2. Принять звонок
        async function answerCall() {
            const offer = prompt("Вставьте предложение от друга:");
            if (!offer) return;
            
            localStream = await navigator.mediaDevices.getUserMedia({ video: true, audio: false });
            document.getElementById('localVideo').srcObject = localStream;
            
            createPeerConnection();
            await peerConnection.setRemoteDescription(JSON.parse(offer));
            
            const answer = await peerConnection.createAnswer();
            await peerConnection.setLocalDescription(answer);
            
            // Показать ответ для копирования
            alert("Скопируйте это и отправьте обратно:\n" + JSON.stringify(answer));
        }
        
        // 3. Создать WebRTC соединение
        function createPeerConnection() {
            peerConnection = new RTCPeerConnection();
            
            // Добавить локальное видео
            localStream.getTracks().forEach(track => {
                peerConnection.addTrack(track, localStream);
            });
            
            // Получить видео от друга
            peerConnection.ontrack = (event) => {
                document.getElementById('remoteVideo').srcObject = event.streams[0];
            };
            
            // Обработка ICE кандидатов
            peerConnection.onicecandidate = (event) => {
                if (event.candidate) {
                    // Игнорируем, так как нет сервера
                }
            };
        }
    </script>
</body>
</html>
